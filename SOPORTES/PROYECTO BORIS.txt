/*Lee la entrada analogica A0, mapea el resultado al rango de 0 a 255 
y utiliza el resutado para poner la anchura del pulso PWM.
 Tambien se escribe en el monitor serie el valor binario de A0 y
 el valor mapeado para la se単al PWM.
 De esta manera controlamos la luminosidad del led verde
 de la placa Edubasica
 
 El circuito:
 * potenciometro conectado a la entrada analogica A0.
   Terminal central del potenciometro a pin A0.
   Resto de terminales del potenciometro a +5V y masa
 * Circuito de LED verde conectado a D3-PWM.
 */

// pines usados:
const int analogInPin = A0;  // Entrada analogica A0 del potenciometro
const int analogOutPin = 3; // Salida PWM
const int digitalOutPin = 12; // Salida Dital

int potValor = 0;        // valor de lectura del potenciometro
int outputValor = 0;     // valor de salida de la se単al PWM 

void setup() {
  // inicializacion del monitor serie a 9600 bps:
  Serial.begin(9600); 
  pinMode(digitalOutPin, OUTPUT);
  digitalWrite(12, LOW); 
}

void loop() {
  // lee el valor de la entrada analogica:
  potValor = analogRead(analogInPin);            
  // mapea el rango para la se単al de salida PWM:
  outputValor = map(potValor, 0, 1023, 0, 255);  
  // asigna el valor cambiado a pin 3 PWM:
  analogWrite(analogOutPin, outputValor);           

  // escribe el resultado en el monitor serie:
  Serial.print("Potenciometro = " );                       
  Serial.print(potValor);      
  Serial.print("\t PWM = ");      
  Serial.println(outputValor);  
   
  if(outputValor<=12){
    digitalWrite(digitalOutPin, HIGH);  
  }
  else
  {
     digitalWrite(digitalOutPin, LOW);  
    }
  
  

  // espera 1 segundo cada bucle para una visualizacion aceptable
  // conviene tener un valor aunque sea peque単o (10ms)
  // por el proceso de conversion de A/D
  delay(1000);                     
}